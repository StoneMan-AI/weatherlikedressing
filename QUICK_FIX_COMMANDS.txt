# ğŸš¨ å¿«é€Ÿä¿®å¤å‘½ä»¤ - å¤åˆ¶ç²˜è´´æ‰§è¡Œ

# ============================================
# æ­¥éª¤1ï¼šå¤‡ä»½å½“å‰é…ç½®
# ============================================
sudo cp /etc/nginx/sites-available/weatherlikedressing /etc/nginx/sites-available/weatherlikedressing.backup.$(date +%Y%m%d_%H%M%S)

# ============================================
# æ­¥éª¤2ï¼šåˆ›å»ºå¿…è¦ç›®å½•
# ============================================
sudo mkdir -p /var/www/certbot
sudo mkdir -p /var/www/weatherlikedressing/frontend/dist
sudo chown -R www-data:www-data /var/www/certbot
sudo chown -R www-data:www-data /var/www/weatherlikedressing

# ============================================
# æ­¥éª¤3ï¼šåˆ›å»ºæ­£ç¡®çš„é…ç½®æ–‡ä»¶
# ============================================
# è¯·å°† nginx_minimal.conf çš„å†…å®¹å¤åˆ¶åˆ°é…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/weatherlikedressing

# æˆ–è€…ç›´æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºï¼ˆä»æ–‡ä»¶å¤åˆ¶ï¼‰
# sudo cp nginx_minimal.conf /etc/nginx/sites-available/weatherlikedressing

# ============================================
# æ­¥éª¤4ï¼šç¡®ä¿é…ç½®æ–‡ä»¶è¢«å¯ç”¨
# ============================================
sudo ln -sf /etc/nginx/sites-available/weatherlikedressing /etc/nginx/sites-enabled/weatherlikedressing

# ============================================
# æ­¥éª¤5ï¼šæµ‹è¯•é…ç½®
# ============================================
sudo nginx -t

# ============================================
# æ­¥éª¤6ï¼šå¦‚æœæµ‹è¯•é€šè¿‡ï¼Œé‡è½½Nginx
# ============================================
sudo systemctl reload nginx

# ============================================
# æ­¥éª¤7ï¼šéªŒè¯ä¿®å¤
# ============================================
# æµ‹è¯•Let's Encryptè·¯å¾„ï¼ˆåº”è¯¥è¿”å›404ï¼Œä¸æ˜¯é‡å®šå‘ï¼‰
curl -I http://adddesigngroup.com/.well-known/acme-challenge/test

# æµ‹è¯•é¦–é¡µ
curl -I http://adddesigngroup.com/

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -20 /var/log/nginx/error.log

# ============================================
# æ£€æŸ¥æ¸…å•
# ============================================
# [ ] è·¯å¾„å·²æ”¹ä¸º /var/www/weatherlikedressing
# [ ] ç«¯å£æ˜¯ 3300
# [ ] .well-known è·¯å¾„åœ¨æœ€å‰é¢
# [ ] å‰ç«¯distç›®å½•å­˜åœ¨ä¸”æœ‰å†…å®¹
# [ ] åç«¯æœåŠ¡è¿è¡Œåœ¨3300ç«¯å£
